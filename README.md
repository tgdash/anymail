# ğŸ“® AnyMail

> âœ¨ åŸºäº Cloudflare Workers çš„ä¸´æ—¶é‚®ç®±éªŒè¯ç æ¥æ”¶æœåŠ¡

[![Cloudflare Workers](https://img.shields.io/badge/Cloudflare-Workers-F38020?logo=cloudflare&logoColor=white)](https://workers.cloudflare.com/)
[![TypeScript](https://img.shields.io/badge/TypeScript-5.0-blue?logo=typescript&logoColor=white)](https://www.typescriptlang.org/)

## ğŸŒŸ åŠŸèƒ½ç‰¹ç‚¹

- ğŸš€ **å¿«é€Ÿéƒ¨ç½²** - ç›´æ¥åœ¨ Cloudflare Workers ä¸­ä½¿ç”¨
- ğŸ” **å®‰å…¨å¯é ** - é€šè¿‡API KEYæ¥ä¿æŠ¤åº”ç”¨
- âš¡ **å®æ—¶æ¥æ”¶** - è‡ªåŠ¨æå–é‚®ä»¶ä¸­çš„ 5-6 ä½éªŒè¯ç 
- ğŸŒ **å¤šåŸŸåæ”¯æŒ** - æ”¯æŒåŒæ—¶é…ç½®å¤šä¸ªåŸŸå
- ğŸ’¾ **è‡ªåŠ¨è¿‡æœŸ** - éªŒè¯ç è®°å½•è‡ªåŠ¨è¿‡æœŸ

## ğŸ“‹ å·¥ä½œåŸç†

1. ğŸ“§ é€šè¿‡ Cloudflare Email Routing æ¥æ”¶é‚®ä»¶
2. ğŸ” è‡ªåŠ¨æå–é‚®ä»¶ä¸­çš„ 5-6 ä½éªŒè¯ç 
3. ğŸ’¾ å°†éªŒè¯ç å­˜å‚¨åˆ° KV æ•°æ®åº“ï¼ˆé»˜è®¤ 10 åˆ†é’Ÿè¿‡æœŸï¼‰
4. ğŸ”‘ é€šè¿‡ API è·å–éªŒè¯ç 

## ğŸš€ éƒ¨ç½²æ­¥éª¤

### å‰ç½®è¦æ±‚

- âœ… Cloudflare è´¦å·
- âœ… å·²æ·»åŠ åˆ° Cloudflare çš„åŸŸå

### æ­¥éª¤ 1ï¼šåœ¨ Cloudflare åˆ›å»º Workers åº”ç”¨

1. è®¿é—® [Cloudflare Dashboard](https://dash.cloudflare.com/)
2. ç‚¹å‡»å·¦ä¾§èœå• **Workers å’Œ Pages**
3. ç‚¹å‡» **åˆ›å»ºåº”ç”¨ç¨‹åº**
4. é€‰æ‹© **åˆ›å»º Workers** æ ‡ç­¾é¡µ
5. ç‚¹å‡» **Continue with GitHub**
6. é€‰æ‹© **é€šè¿‡ Git URL å…‹éš†å…¬å…±å­˜å‚¨åº“**
7. è¾“å…¥é¡¹ç›® URLï¼š
   ```
   https://github.com/tgdash/anymail
   ```
8. ç‚¹å‡» **å¼€å§‹è®¾ç½®**

### æ­¥éª¤ 2ï¼šé…ç½®ç¯å¢ƒå˜é‡

åœ¨éƒ¨ç½²è®¾ç½®é¡µé¢ï¼Œæ·»åŠ ä»¥ä¸‹ç¯å¢ƒå˜é‡ï¼š

| å˜é‡å | å€¼ | è¯´æ˜ |
|--------|-----|------|
| `DOMAINS` | `yourdomain.com` | ğŸ‘ˆ ä¿®æ”¹ä¸ºä½ çš„åŸŸåï¼ˆå¤šä¸ªåŸŸåç”¨é€—å·åˆ†éš”ï¼Œå¦‚ a.com,b.comï¼‰ |
| `ACCESS_KEY` | `your-secret-key` | ğŸ‘ˆ ä¿®æ”¹ä¸ºä½ çš„è‡ªå®šä¹‰å¯†é’¥ |

> âš ï¸ **é‡è¦**ï¼šè¯·åŠ¡å¿…ä¿®æ”¹ `DOMAINS` ä¸ºä½ å®é™…ä½¿ç”¨çš„åŸŸåï¼Œå¹¶è®¾ç½®ä¸€ä¸ªå¼ºå¯†ç ä½œä¸º `ACCESS_KEY`

### æ­¥éª¤ 3ï¼šåˆ›å»º KV å‘½åç©ºé—´

1. åœ¨éƒ¨ç½²è®¾ç½®é¡µé¢ï¼Œæ‰¾åˆ° **KV å‘½åç©ºé—´ç»‘å®š** éƒ¨åˆ†
2. ç‚¹å‡» **æ·»åŠ ç»‘å®š**
3. å˜é‡åç§°ï¼š`ANYMAIL_CODES`
4. ç‚¹å‡» **åˆ›å»ºæ–°çš„å‘½åç©ºé—´**ï¼Œåç§°å¡«å†™ `ANYMAIL_CODES`
5. é€‰æ‹©åˆšåˆ›å»ºçš„å‘½åç©ºé—´

### æ­¥éª¤ 4ï¼šå®Œæˆéƒ¨ç½²

1. ç‚¹å‡» **ä¿å­˜å¹¶éƒ¨ç½²**
2. ç­‰å¾…éƒ¨ç½²å®Œæˆ
3. è®°å½•ä½ çš„ Workers è®¿é—®åœ°å€ï¼š`https://*.workers.dev`

### æ­¥éª¤ 5ï¼šé…ç½®é‚®ä»¶è·¯ç”±

1. åœ¨ [Cloudflare Dashboard](https://dash.cloudflare.com/) ä¸­é€‰æ‹©è¦é…ç½®çš„åŸŸå
2. ç‚¹å‡»å·¦ä¾§èœå• **ç”µå­é‚®ä»¶** â†’ **ç”µå­é‚®ä»¶è·¯ç”±**
3. å¦‚æœæœªå¯ç”¨ï¼Œç‚¹å‡» **å¯ç”¨ç”µå­é‚®ä»¶è·¯ç”±**
4. ç‚¹å‡» **è·¯ç”±è§„åˆ™** æ ‡ç­¾é¡µ
5. æ‰¾åˆ° **Catch-all åœ°å€**ï¼Œç‚¹å‡» **ç¼–è¾‘**
6. æ“ä½œé€‰æ‹©ï¼š**å‘é€åˆ° Worker**
7. Worker é€‰æ‹©ï¼šåˆšåˆšåˆ›å»ºçš„ Workersï¼ˆå¦‚ï¼š`anymail`ï¼‰
8. ç‚¹å‡» **ä¿å­˜**

> ğŸ’¡ **æç¤º**ï¼šCatch-all è§„åˆ™ä¼šæ•è·æ‰€æœ‰å‘é€åˆ°è¯¥åŸŸåçš„é‚®ä»¶

### æ­¥éª¤ 6ï¼šåœ¨ TGDash ä¸­æ·»åŠ æµ‹è¯•

1. è¿›å…¥ä¸´æ—¶é‚®ç®±è®¾ç½®
2. æ·»åŠ æ–°çš„é‚®ä»¶æœåŠ¡ï¼š
   - **Wokers åŸŸå**ï¼šåœ¨ Workers è®¾ç½®ä¸­æ‰¾åˆ°çš„åŸŸåï¼ˆ`https://your-worker-name.workers.dev`ï¼‰
   - **Access Token**ï¼šä¹‹å‰é…ç½®çš„ `ACCESS_KEY`
3. ä¿å­˜å¹¶æµ‹è¯•æ–°å»ºé‚®ç®±ï¼Œæµ‹è¯•æ¥å—ä¸äº†

## ğŸ“– ä½¿ç”¨è¯´æ˜

### API ç«¯ç‚¹

ä½ ä¹Ÿå¯ä»¥åœ¨è‡ªå·±çš„é¡¹ç›®ä¸­å¯¹æ¥

#### è·å–åŸŸååˆ—è¡¨

```bash
curl -H "Authorization: Bearer your-secret-key" \
     https://your-worker-name.workers.dev/
```

å“åº”ï¼š
```json
{
  "domains": ["yourdomain.com"]
}
```

#### è·å–éªŒè¯ç 

```bash
curl -H "Authorization: Bearer your-secret-key" \
     https://your-worker-name.workers.dev/user@yourdomain.com
```

å“åº”ï¼ˆæœ‰éªŒè¯ç ï¼‰ï¼š
```json
{
  "code": "123456"
}
```

å“åº”ï¼ˆæ— éªŒè¯ç ï¼‰ï¼š
```json
{
  "code": ""
}
```

### ğŸ”§ ç¯å¢ƒå˜é‡è¯´æ˜

| å˜é‡ | è¯´æ˜ | é»˜è®¤å€¼ | å¿…å¡« |
|------|------|--------|------|
| `DOMAINS` | é€—å·åˆ†éš”çš„å…è®¸åŸŸååˆ—è¡¨ | - | âœ… |
| `ACCESS_KEY` | API è®¿é—®å¯†é’¥ | - | âœ… |
| `CODE_TTL_SECONDS` | éªŒè¯ç è¿‡æœŸæ—¶é—´ï¼ˆç§’ï¼‰ | 600 | âŒ |

## âš ï¸ æ³¨æ„äº‹é¡¹

- ğŸ”’ è¯·å¦¥å–„ä¿ç®¡ `ACCESS_KEY`ï¼Œé¿å…æ³„éœ²
- â±ï¸ éªŒè¯ç é»˜è®¤ 10 åˆ†é’Ÿåè‡ªåŠ¨è¿‡æœŸ
- ğŸ“§ ç¡®ä¿åœ¨ Email Routing ä¸­æ­£ç¡®é…ç½®äº† Worker
- ğŸŒ DOMAINS é…ç½®çš„åŸŸåå¿…é¡»ä¸ Email Routing çš„åŸŸåä¸€è‡´

## ğŸ“„ è®¸å¯è¯

Mozilla Public License Version 2.0

## ğŸ™‹ é—®é¢˜åé¦ˆ

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œæ¬¢è¿æäº¤ [Issue](../../issues) ğŸ’¬

---

ğŸ’– Made with Cloudflare Workers by TGDash Team.